<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kru Pai Classroom ‚Äì ‡∏Ñ‡∏π‡∏ì‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏° (30 ‡∏Ç‡πâ‡∏≠)</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* ‡πÉ‡∏ä‡πâ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô */
:root{--bg:#f5fbff;--ink:#0b2540;--muted:#5d7896;--line:#cfe1ff;--pri:#4dafff;--pri2:#2e8de6;--ok:#18b77a;--bad:#ff5b7d;--gold1:#fff7d1;--gold2:#ffd54d;--gold3:#ffa000}
*{box-sizing:border-box} html,body{height:100%;margin:0;font-family:Fredoka,sans-serif;background:linear-gradient(180deg,#f7fbff,#eef6ff)}
.hidden{display:none!important}
.btn{background:linear-gradient(135deg,var(--pri),var(--pri2));color:#fff;border:none;border-radius:16px;padding:14px 18px;font-weight:800;cursor:pointer;font-size:18px}
.btn.lg{font-size:20px;padding:16px 20px;border-radius:18px}
.ghost{background:#fff;color:var(--pri2);border:2px solid var(--pri)}
.card{width:min(820px,94vw);background:#fff;border:1px solid var(--line);border-radius:24px;box-shadow:0 14px 34px rgba(46,141,230,.14);padding:24px}
.brand{display:flex;align-items:center;gap:14px}
.logo{width:64px;height:64px;border-radius:20px;background:conic-gradient(#ff8a00,#ffd54d,#ff8a00);display:grid;place-items:center;color:#fff;font-weight:900;font-size:22px}
.title{font-size:30px;font-weight:900}
.subtitle{color:#6a88a7;font-size:14px}
.stage{min-height:calc(100vh - 220px);display:flex;align-items:center;justify-content:center;flex-direction:column;gap:16px;padding:16px}
.q{font-size:clamp(32px,7.5vw,56px);font-weight:900;text-align:center;background:#fff;border:1px solid var(--line);border-radius:24px;box-shadow:0 12px 28px rgba(46,141,230,.14);padding:22px}
.eq{display:flex;align-items:center;justify-content:center;gap:16px;flex-wrap:wrap}
.ans{min-width:220px;display:inline-flex;align-items:center;justify-content:center;padding:12px 16px;font-size:clamp(30px,7vw,46px);font-weight:900;border:3px dashed var(--line);border-radius:16px;background:#f8fbff;color:#2d4e6d}
.ans.good{border:3px solid var(--ok);background:#eafff6;color:#095e3f}
.ans.bad{border:3px solid var(--bad);background:#fff0f4;color:#8a1230}
.stars{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;min-height:28px;margin-top:8px}
.star{width:24px;height:24px;border-radius:50%;background:radial-gradient(circle at 30% 30%,var(--gold1),var(--gold2) 60%,var(--gold3))}
.bomb{width:24px;height:24px;border-radius:50%;background:radial-gradient(circle at 30% 30%,#ffb3b3,#ff5252 60%,#b71c1c)}
.keypad{position:sticky;bottom:0;background:#fff;border-top:1px solid var(--line);padding:12px}
.keys{width:min(820px,94vw);margin:0 auto;display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.key{padding:16px 0;text-align:center;font-size:24px;font-weight:900;border-radius:16px;background:#eaf5ff;color:#0e2c47;border:2px solid #bfe3ff;cursor:pointer}
.key.wide{grid-column:span 3}
</style>
</head>
<body>

<!-- START -->
<section id="start">
  <div class="card">
    <div class="brand"><div class="logo">KP</div><div><div class="title">Kru Pai Classroom</div><div class="subtitle">‡∏ù‡∏∂‡∏Å‡∏Ñ‡∏π‡∏ì‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏° ‚Äì 30 ‡∏Ç‡πâ‡∏≠</div></div></div>
    <p><b>‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤:</b> ‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤ 5 ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏ó‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ñ‡∏π‡∏ì‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 30 ‡∏Ç‡πâ‡∏≠) ‚Äì ‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πâ‡∏ï‡∏±‡∏ß 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ñ‡πâ‡∏≤‡∏ú‡∏¥‡∏î‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô üí£ ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠</p>
    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
    <input id="player" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡πâ‡∏≠‡∏á‡∏û‡∏≤‡∏¢" style="width:100%;padding:14px;font-size:18px;margin:10px 0;border:2px solid var(--line);border-radius:14px"/>
    <button id="btnStart" class="btn lg">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
  </div>
</section>

<!-- GAME -->
<section id="game" class="hidden">
  <div class="card">
    <div style="font-size:20px;font-weight:800;margin-bottom:10px">‡∏ä‡∏∑‡πà‡∏≠: <span id="who">‚Äî</span> | ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà <span id="idx">1</span>/30 | ‚≠ê <span id="starsCount">0</span></div>
    <div class="q"><span id="expr">‚Äî</span> = <span id="ans" class="ans">?</span></div>
    <div style="margin-top:8px">‡∏ú‡∏¥‡∏î‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å: <b id="retryLeft">1</b> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á | ‡πÄ‡∏ß‡∏•‡∏≤: <span id="timeLeft">5:00</span></div>
    <div id="stars" class="stars"></div>
  </div>
  <div class="keypad"><div class="keys" id="keys"></div></div>
</section>

<!-- DONE -->
<section id="done" class="hidden">
  <div class="card" style="text-align:center">
    <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</h2>
    <p><b id="sumName">‚Äî</b> ‡πÑ‡∏î‡πâ ‚≠ê <b id="sumStars">0</b> ‡∏î‡∏ß‡∏á</p>
    <p>‡∏ó‡∏≥‡πÑ‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <b id="sumIdx">0</b> / 30 ‡∏Ç‡πâ‡∏≠</p>
    <div id="finalStars" class="stars"></div>
    <button id="btnPlayAgain" class="btn lg">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
    <button id="btnToHome" class="btn lg ghost">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
  </div>
</section>

<script>
const $=s=>document.querySelector(s);
const state={name:"‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô",limit:30,timeLimit:300,idx:0,stars:0,current:{},input:"",timer:null,timeLeft:300,running:false,retry:1};

function rand(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
function choice(arr){return arr[Math.floor(Math.random()*arr.length)];}

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ñ‡∏π‡∏ì‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°
function genExpr(){
  const a=(Math.random()<0.5?rand(1,20):rand(1,9)+Math.random()).toFixed(choice([0,1,2]));
  const b=(Math.random()<0.5?rand(1,20):rand(1,9)+Math.random()).toFixed(choice([0,1]));
  const ans=(parseFloat(a)*parseFloat(b)).toFixed(2);
  return {text:`${a} √ó ${b}`,answer:ans.replace(/\.00$/,"").replace(/(\.\d)0$/,"$1")};
}

// HUD
function fmtTime(sec){const m=Math.floor(sec/60),s=sec%60;return `${m}:${String(s).padStart(2,"0")}`;}
function setHUD(){ $("#who").textContent=state.name; $("#idx").textContent=state.idx+1; $("#starsCount").textContent=state.stars; $("#retryLeft").textContent=state.retry; $("#timeLeft").textContent=fmtTime(state.timeLeft);}
function showExpr(){ $("#expr").textContent=state.current.text; $("#ans").textContent=state.input||"?"; $("#ans").classList.remove("good","bad"); }

function addStar(){state.stars++;$("#starsCount").textContent=state.stars;const s=document.createElement("span");s.className="star";$("#stars").appendChild(s);}
function addBomb(){const b=document.createElement("span");b.className="bomb";$("#stars").appendChild(b);}

function pushDigit(d){if(!state.running)return;state.input+=d;showExpr();}
function backspace(){state.input=state.input.slice(0,-1);showExpr();}
function submit(){
  if(!state.running||state.input==="")return;
  if(state.input==state.current.answer){
    $("#ans").classList.add("good"); addStar(); setTimeout(next,250);
  }else{
    $("#ans").classList.add("bad");
    if(state.retry>0){state.retry--;setHUD();setTimeout(()=>{state.input="";showExpr();},180);}
    else{addBomb();setTimeout(next,250);}
  }
}

function next(){ if(state.idx>=state.limit-1){finish();return;} state.idx++;state.current=genExpr();state.input="";state.retry=1;setHUD();showExpr(); }
function startTimer(){clearInterval(state.timer);state.timeLeft=state.timeLimit;state.timer=setInterval(()=>{if(!state.running)return;state.timeLeft--;setHUD();if(state.timeLeft<=0)finish();},1000);}
function start(){state.name=$("#player").value||"‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô";state.idx=0;state.stars=0;state.input="";state.retry=1;state.current=genExpr();state.timeLeft=state.timeLimit;state.running=true;$("#stars").innerHTML="";$("#start").classList.add("hidden");$("#done").classList.add("hidden");$("#game").classList.remove("hidden");setHUD();showExpr();startTimer();}
function finish(){if(!state.running)return;state.running=false;clearInterval(state.timer);$("#sumName").textContent=state.name;$("#sumStars").textContent=state.stars;$("#sumIdx").textContent=state.idx+1;const fin=$("#finalStars");fin.innerHTML="";for(let i=0;i<state.stars;i++){const s=document.createElement("span");s.className="star";fin.appendChild(s);}$("#game").classList.add("hidden");$("#done").classList.remove("hidden");}

// Keypad
(function(){const keys=["7","8","9","4","5","6","1","2","3","0",".","‚å´","‡∏™‡πà‡∏á"];const box=$("#keys");keys.forEach(k=>{const b=document.createElement("div");b.className="key"+(k==="‡∏™‡πà‡∏á"?" wide":"");b.textContent=k;b.onclick=()=>{if(k==="‚å´")backspace();else if(k==="‡∏™‡πà‡∏á")submit();else pushDigit(k);};box.appendChild(b);});})();
document.addEventListener("keydown",e=>{if($("#game").classList.contains("hidden"))return;if(/[0-9.]/.test(e.key))pushDigit(e.key);else if(e.key==="Backspace")backspace();else if(e.key==="Enter")submit();});

// Buttons
$("#btnStart").onclick=start;$("#btnPlayAgain").onclick=start;$("#btnToHome").onclick=()=>{$("#done").classList.add("hidden");$("#start").classList.remove("hidden");};
</script>
</body>
</html>
